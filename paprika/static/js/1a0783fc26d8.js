$(document).ready(function(){$("#collapse_btn").click(function(){if($(".stages").is(":visible")){$(".stages").slideUp(200);$(this).text("Expand");}
else{$(".stages").slideDown(200);$(this).text("Collapse");}});$(".order").click(function(){if($(this).children(".stages").is(":hidden")){$(this).children(".stages").slideDown(200);}
else{$(this).children(".stages").slideUp(200);}});$(".stages").click(function(e){e.stopPropagation();});$("#add_order_btn").click(function(){$("#dialogs").fadeIn(200,function(){$("#add_order_dialog").fadeIn(200);});});$(".close_dialog, .close").click(function(){$(this).parent().fadeOut(200,function(){$("#dialogs").fadeOut(200);});});$(".stage").click(function(){if(!$(this).children('.status_bar').hasClass('active')){order_id=$(this).parent().parent().attr("data-orderid");stage_index=$(this).attr("data-stageid");$(this).siblings(".active").removeClass("active");$(this).addClass("active");$(this).children(".status_bar").attr("style","");$.ajax({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",$.cookie('csrftoken'));},type:"POST",url:"/ajax/move_stage/",data:{"stage_index":stage_index,"order_id":order_id,},async:true,success:function(response){console.log(response);},error:function(response){console.log(response);}});}});$(".delete_btn").click(function(e){e.stopPropagation();currentFlow=$(this).parent().parent();$("#dialogs").fadeIn(200,function(){$("#delete_order_dialog").fadeIn(200);});});$("#yes_delete_btn").click(function(){orderId=$(currentFlow).attr("data-orderid");$.ajax({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",$.cookie('csrftoken'));},type:"POST",url:"/ajax/delete_order/",data:{"order_id":orderId},async:true,success:function(response){console.log(response);},error:function(response){console.log(response);}});$("#delete_order_dialog").fadeOut(200,function(){$("#dialogs").fadeOut(200);});$(currentFlow).delay(400).slideUp(200);});$(".current_state").click(function(e){state_options=$(this).siblings(".state_options");if($(state_options).is(":hidden")){$(".state_options").fadeOut(200);$(state_options).fadeIn(200);}
else{$(state_options).fadeOut(200);}
e.stopPropagation();});$(".state_options .btn").click(function(e){new_state=$(this).attr("data-state");orderdiv=$(this).parent().parent().parent();current_state=$(orderdiv).attr("data-orderstate");order_id=$(orderdiv).attr("data-orderid");if(current_state!=new_state){$(this).parent().slideDown(200,function(){$(orderdiv).slideUp(200);});$.ajax({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",$.cookie('csrftoken'));},type:"POST",url:"/ajax/set_state/",data:{"order_id":order_id,"new_state":new_state},async:true,success:function(response){},error:function(response){}});}
e.stopPropagation();});});